---
import '../styles/global.css';

const menuCategories = [
  'Musica',
  'Mundo',
  'Deportes y Futbol',
  'Varios',
  'Packs Mayorista',
  'Encededores y Cargadores'
];

const { title = 'FT Calcos', description = 'Calcos personalizados para todos tus productos.' } = Astro.props;
const rawBase = import.meta.env.BASE_URL || '/';
const dataBase = rawBase.endsWith('/') ? rawBase : `${rawBase}/`;
const basePrefix = rawBase === '/' ? '' : rawBase.replace(/\/$/, '');
const withBase = (path: string) => `${basePrefix}${path.startsWith('/') ? path : `/${path}`}` || '/';
const scriptSrc = withBase('/scripts/cart-client.js');
---
<!DOCTYPE html>
<html lang="es" data-base={dataBase}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />
    <title>{title}</title>
  </head>
  <body class="min-h-screen text-slate-900 flex flex-col">
    <header class="sticky top-0 z-40 border-b border-slate-200 bg-white/95 backdrop-blur">
      <div class="mx-auto flex max-w-6xl items-center justify-between px-4 py-3">
        <button
          class="rounded-2xl border border-slate-200 p-2 text-slate-700 hover:bg-slate-50"
          data-nav-toggle="open"
          aria-label="Abrir menu"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="1.8">
            <path d="M4 7H20" stroke-linecap="round" />
            <path d="M4 12H20" stroke-linecap="round" />
            <path d="M4 17H20" stroke-linecap="round" />
          </svg>
        </button>
        <a href={dataBase} class="text-xl font-bold tracking-[0.3em] text-slate-900">FT</a>
        <a href={withBase('/carrito')} class="relative" aria-label="Ir al carrito">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-7 w-7 text-primary" fill="none" stroke="currentColor" stroke-width="1.6">
            <path d="M6 6H21L19 13H8L6 6Z" stroke-linecap="round" stroke-linejoin="round" />
            <circle cx="9.5" cy="18.5" r="1.2" />
            <circle cx="17.5" cy="18.5" r="1.2" />
          </svg>
          <span class="absolute -right-2 -top-2 flex h-5 w-5 items-center justify-center rounded-full bg-primary text-xs font-semibold text-white" data-cart-count>0</span>
        </a>
      </div>
    </header>
    <main class="flex-1 w-full max-w-6xl mx-auto px-4 py-10">
      <slot />
    </main>
    <footer class="bg-primary text-white text-sm">
      <div class="max-w-6xl mx-auto px-4 py-6 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
        <p>&copy; {new Date().getFullYear()} FT Calcos. Todos los derechos reservados.</p>
      </div>
    </footer>
    <div class="nav-drawer" data-nav-drawer aria-hidden="true">
      <button class="nav-overlay" data-nav-toggle="close" aria-label="Cerrar menu"></button>
      <aside class="nav-panel">
        <div class="flex items-center justify-between">
          <span class="text-lg font-semibold text-slate-900">Menu</span>
          <button class="rounded-full border border-slate-200 p-2 text-slate-500" data-nav-toggle="close" aria-label="Cerrar">
            &times;
          </button>
        </div>
        <nav class="mt-6 space-y-4 text-base font-medium text-slate-700">
          <a href={dataBase} class="block rounded-2xl bg-slate-100 px-4 py-3 hover:bg-slate-200" data-nav-toggle="close">Inicio</a>
          <button
            type="button"
            class="flex w-full items-center justify-between rounded-2xl border border-slate-200 px-4 py-3 text-left hover:border-primary"
            data-filter-category="all"
            data-filter-label="Todos los calcos"
          >
            <span>Ver todos los productos</span>
            <span class="text-xs uppercase tracking-widest text-slate-400">All</span>
          </button>
          <div class="space-y-2">
            <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">Categorias</p>
            {menuCategories.map((category) => (
              <button
                type="button"
                class="w-full rounded-2xl border border-slate-200 px-4 py-3 text-left hover:border-primary"
                data-filter-category={category}
                data-filter-label={category}
              >
                {category}
              </button>
            ))}
          </div>
        </nav>
      </aside>
    </div>
    <a
      href={withBase('/carrito')}
      data-cart-floating
      class="fixed bottom-24 right-4 z-40 flex items-center gap-2 rounded-full bg-primary px-5 py-3 text-sm font-semibold text-white shadow-xl hover:bg-slate-900"
    >
      ?? Carrito (<span data-cart-count>0</span>)
    </a>
    <a
      href="https://wa.me/5493585760730"
      target="_blank"
      rel="noopener noreferrer"
      class="fixed bottom-4 right-4 z-40 flex h-14 w-14 items-center justify-center rounded-full bg-[#25D366] text-white shadow-2xl transition-transform hover:scale-105 focus-visible:scale-105 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[#25D366]"
      aria-label="Contactar por WhatsApp"
    >
      <svg viewBox="0 0 32 32" fill="currentColor" class="h-7 w-7">
        <path d="M16.04 6c-4.96 0-9 3.99-9 8.91 0 1.57.43 3.11 1.25 4.46l-1.34 4.9 5.05-1.32a9.07 9.07 0 003.99.95h.01c4.96 0 9-3.99 9-8.91C24 9.99 21 6 16.04 6zm5.28 12.75c-.2.57-1.16 1.09-1.6 1.15-.41.06-.94.08-1.52-.09-.35-.11-.8-.26-1.38-.51-2.43-1.05-4-3.5-4.12-3.66-.12-.17-.98-1.3-.98-2.48 0-1.18.62-1.76.83-2 .21-.23.47-.29.62-.29h.44c.14.01.33-.05.52.4.2.47.69 1.64.75 1.76.06.12.1.26.02.42-.08.17-.12.27-.24.42-.12.14-.25.32-.36.43-.12.12-.24.25-.1.49.14.23.61 1 1.31 1.62.9.81 1.66 1.06 1.89 1.18.23.12.37.1.51-.05.14-.14.59-.69.75-.93.16-.23.32-.2.52-.12.21.08 1.33.62 1.56.73.23.12.38.17.43.26.06.08.06.48-.14 1.05z"/>
      </svg>
    </a>
    <script type="module" src={scriptSrc}></script>
  </body>
</html>
